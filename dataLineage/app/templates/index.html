<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Lineage Visualization</title>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/treemap.js"></script>
    <script src="https://code.highcharts.com/modules/treegraph.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            fetch('/lineage')
                .then(response => response.json())
                .then(data => {
                alert(Object.values(data))
                    // Create the chart
                    Highcharts.chart('container', {
                            chart: {
                                spacingBottom: 30,
                                marginRight: 120,
                                height: 1200
                            },
                            title: {
                            text: 'Data Lineage'
                        },
                        series: [{
                                    type: 'treegraph',
                                    keys: ['parent', 'id', 'level'],
                                    clip: false,
                            data: data,
           dataLabels: {
                align: 'left',
                pointFormat: '{point.id}',
                style: {
                    color: '#000000',
                    textOutline: '3px #ffffff',
                    whiteSpace: 'nowrap'
                },
                x: 24,
                crop: false,
                overflow: 'none'
            },levels: [
                {
                    level: 1,
                    levelIsConstant: false
                },
                {
                    level: 2,
                    colorByPoint: true
                },
                {
                    level: 3,
                    colorVariation: {
                        key: 'brightness',
                        to: -0.5
                    }
                },
                {
                    level: 4,
                    colorVariation: {
                        key: 'brightness',
                        to: 0.5
                    }
                },
                {
                    level: 6,
                    dataLabels: {
                        x: 10
                    },
                    marker: {
                        radius: 4
                    }
                }
            ]

                        }],
                        tooltip: {
                            pointFormat: '{point.name}'
                        }
                    });
                })
                .catch(error => console.error('Error fetching lineage data:', error));
        });
    </script>
</head>
<body>
    <div id="container" style="width: 100%; height: 600px;"></div>
</body>
</html>
